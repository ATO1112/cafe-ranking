<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âñ´Ëå∂„É©„É≥„Ç≠„É≥„Ç∞</title>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        /* ËÉåÊôØË®≠ÂÆöÔºà„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥Ôºâ */
        body {
            position: relative;
            background: linear-gradient(135deg, #8B4513 0%, #D2B48C 50%, #F5DEB3 100%);
            background-attachment: fixed;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(139, 69, 19, 0.1) 2px,
                rgba(139, 69, 19, 0.1) 4px
            ),
            repeating-linear-gradient(
                90deg,
                transparent,
                transparent 20px,
                rgba(160, 82, 45, 0.1) 20px,
                rgba(160, 82, 45, 0.1) 22px
            );
            pointer-events: none;
            z-index: -1;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä */
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Êé•Á∂öÁä∂ÊÖãË°®Á§∫ */
        .connection-status {
            text-align: center;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .status-connected {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .status-connecting {
            background: linear-gradient(45deg, #FF9800, #F57C00);
            color: white;
        }

        .status-disconnected {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }

        /* „Ç¢„Ç§„ÉÜ„É†Ë°®Á§∫ */
        .item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 10px 0;
            background: linear-gradient(90deg, rgba(255, 248, 220, 0.8), rgba(255, 255, 255, 0.9));
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 5px solid #8B4513;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .item-info {
            display: flex;
            align-items: center;
            flex-grow: 1;
        }

        .item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-right: 15px;
        }

        .item-count {
            font-size: 18px;
            font-weight: bold;
            color: #8B4513;
            min-width: 30px;
        }

        .item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item button {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .item .plus {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .item .plus:hover {
            background: linear-gradient(45deg, #45a049, #3d8b40);
            transform: scale(1.1);
        }

        .item .minus {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }

        .item .minus:hover {
            background: linear-gradient(45deg, #da190b, #c41e3a);
            transform: scale(1.1);
        }

        .item button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        h1, h2 {
            color: #8B4513;
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        /* „É¢„Éº„ÉâË°®Á§∫ */
        .staff-mode {
            background: linear-gradient(45deg, #ff6b6b, #ffa8a8);
            color: white;
            border: none;
            padding: 15px 20px;
            margin-bottom: 30px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .customer-mode {
            background: linear-gradient(45deg, #51cf66, #8ce99a);
            color: white;
            border: none;
            padding: 15px 20px;
            margin-bottom: 30px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(81, 207, 102, 0.3);
        }

        /* „ÉÅ„É£„Éº„Éà */
        .chart-container {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        #chart {
            max-width: 100%;
            height: auto;
        }

        /* „Éá„Éº„Çø„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥ */
        .reset-button {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.2s;
        }

        .reset-button:hover {
            background: linear-gradient(45deg, #f57c00, #ef6c00);
            transform: translateY(-2px);
        }

        .reset-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøúÔºà„Çπ„Éû„ÉõÈáçË¶ñÔºâ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
                margin: 0;
            }

            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }

            h2 {
                font-size: 1.3em;
                margin-bottom: 15px;
            }

            .item {
                padding: 12px 15px;
                margin: 8px 0;
                flex-direction: row;
                align-items: center;
            }

            .item-name {
                font-size: 14px;
                margin-right: 10px;
                flex: 1;
                min-width: 0;
                word-wrap: break-word;
            }

            .item-count {
                font-size: 16px;
                min-width: 40px;
                text-align: center;
            }

            .item-controls {
                gap: 8px;
                flex-shrink: 0;
            }

            .item button {
                width: 35px;
                height: 35px;
                font-size: 18px;
                touch-action: manipulation;
            }

            .staff-mode, .customer-mode {
                padding: 12px 15px;
                margin-bottom: 20px;
                font-size: 14px;
            }

            .chart-container {
                padding: 15px;
                margin-top: 20px;
            }

            #chart {
                width: 100% !important;
                height: 300px !important;
            }

            .reset-button {
                padding: 8px 15px;
                font-size: 14px;
                margin-top: 15px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 1.5em;
            }

            .item-name {
                font-size: 13px;
            }

            .item button {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }

            #chart {
                height: 250px !important;
            }
        }

        /* „Çø„ÉÉ„ÉÅ„Éá„Éê„Ç§„ÇπÁî®„ÅÆË™øÊï¥ */
        @media (hover: none) and (pointer: coarse) {
            .item button {
                min-height: 44px;
                min-width: 44px;
            }

            .item:hover {
                transform: none;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="connection-status" class="connection-status status-connecting">
            üîÑ „Éá„Éº„Çø„Éô„Éº„Çπ„Å´Êé•Á∂ö‰∏≠...
        </div>
        <div id="mode-indicator"></div>
        <h1>‚òï Âñ´Ëå∂„É©„É≥„Ç≠„É≥„Ç∞</h1>
        <div id="item-list"></div>
        <div class="chart-container">
            <h2>üìä „É™„Ç¢„É´„Çø„Ç§„É†„Ç∞„É©„Éï</h2>
            <canvas id="chart" width="600" height="400"></canvas>
        </div>
    </div>

    <script>
        // FirebaseË®≠ÂÆö
        const firebaseConfig = {
            apiKey: "AIzaSyArg_XriS8_FI02L95OiDpNdXdpwKOlOgE",
            authDomain: "cafe-ranking-new.firebaseapp.com",
            databaseURL: "https://cafe-ranking-new-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "cafe-ranking-new",
            storageBucket: "cafe-ranking-new.firebasestorage.app",
            messagingSenderId: "809007147194",
            appId: "1:809007147194:web:2fce235c5bc86a740eba83"
        };

        // FirebaseÂàùÊúüÂåñ
        let database;
        let isFirebaseConnected = false;

        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            console.log('FirebaseÂàùÊúüÂåñÂÆå‰∫Ü');
        } catch (error) {
            console.error('FirebaseÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
            updateConnectionStatus('disconnected', 'FirebaseË®≠ÂÆö„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        }

        // URL„Éë„É©„É°„Éº„Çø„Çí„ÉÅ„Çß„ÉÉ„ÇØ
        const urlParams = new URLSearchParams(window.location.search);
        const isStaff = urlParams.get('mode') === 'staff';

        // Â∫óÂì°„É¢„Éº„Éâ„ÅÆÂ†¥Âêà„ÄÅÁ∞°Êòì„Éë„Çπ„ÉØ„Éº„Éâ„ÉÅ„Çß„ÉÉ„ÇØ
        if (isStaff) {
            const password = prompt("Â∫óÂì°Áî®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:");
            if (password !== "takapan") {
                alert("„Éë„Çπ„ÉØ„Éº„Éâ„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åæ„Åô");
                window.location.href = window.location.pathname;
            }
        }

        // „Ç¢„Ç§„ÉÜ„É†„É™„Çπ„Éà
        const items = [
            "„Åø„Åü„Çâ„ÅóÂõ£Â≠ê",
            "„ÉØ„ÉÉ„Éï„É´",
            "„Çº„É™„Éº",
            "Â§è„ÅÆÂ§ú„ÅÆÂ§¢„ÅÆÊÉö„ÇåËñ¨",
            "‰∫∫È≠öÂß´„ÅÆÊ∂ô",
            "‰∏çÊÄùË≠∞„ÅÆÂõΩ„ÅÆÈ≠îÊ≥ï",
            "„ÉÅ„É£„Ç∑„É£„Éç„Ç≥„ÅÆ„ÅäËå∂‰ºötea"
        ];

        const itemCounts = {};
        const itemListDiv = document.getElementById("item-list");

        // „Çø„Ç§„Éà„É´„Å®Ë°®Á§∫„ÇíÂãïÁöÑ„Å´Â§âÊõ¥
        document.title = isStaff ? "Âñ´Ëå∂„É©„É≥„Ç≠„É≥„Ç∞ÔºàÂ∫óÂì°Áî®Ôºâ" : "Âñ´Ëå∂„É©„É≥„Ç≠„É≥„Ç∞Ôºà„ÅäÂÆ¢ÊßòÁî®Ôºâ";

        // Êé•Á∂öÁä∂ÊÖã„ÇíÊõ¥Êñ∞
        function updateConnectionStatus(status, message = '') {
            const statusElement = document.getElementById('connection-status');
            const statusText = {
                connecting: 'üîÑ „Éá„Éº„Çø„Éô„Éº„Çπ„Å´Êé•Á∂ö‰∏≠...',
                connected: '‚úÖ „É™„Ç¢„É´„Çø„Ç§„É†ÂêåÊúü‰∏≠',
                disconnected: '‚ùå Êé•Á∂ö„Ç®„É©„Éº'
            };
            
            statusElement.className = `connection-status status-${status}`;
            statusElement.textContent = message || statusText[status];
            
            // „Éú„Çø„É≥„ÅÆÊúâÂäπ/ÁÑ°Âäπ„ÇíÂàá„ÇäÊõø„Åà
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => {
                btn.disabled = status !== 'connected';
            });
        }

        // „É¢„Éº„ÉâË°®Á§∫
        const modeIndicator = document.getElementById('mode-indicator');
        if (isStaff) {
            modeIndicator.innerHTML = '<div class="staff-mode"><strong>üîß Â∫óÂì°„É¢„Éº„Éâ</strong> - Êï∞Èáè„ÅÆÂ§âÊõ¥„ÅåÂèØËÉΩ„Åß„Åô<br><button class="reset-button" onclick="resetAllData()">„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà</button></div>';
        } else {
            modeIndicator.innerHTML = '<div class="customer-mode"><strong>üë• „ÅäÂÆ¢ÊßòÁî®Ë°®Á§∫</strong> - „É™„Ç¢„É´„Çø„Ç§„É†Ë°®Á§∫</div>';
        }

        // Firebase„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
        function loadFirebaseData() {
            if (!database) return;

            try {
                database.ref('cafeRanking').on('value', (snapshot) => {
                    const data = snapshot.val();
                    let hasChanges = false;

                    items.forEach(item => {
                        const newCount = (data && data[item]) ? data[item] : 0;
                        if (itemCounts[item] !== newCount) {
                            itemCounts[item] = newCount;
                            hasChanges = true;
                        }
                    });

                    if (hasChanges) {
                        updateDisplay();
                    }

                    // ÂàùÂõûÊé•Á∂öÂÆå‰∫Ü
                    if (!isFirebaseConnected) {
                        isFirebaseConnected = true;
                        updateConnectionStatus('connected');
                    }
                }, (error) => {
                    console.error('FirebaseË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
                    updateConnectionStatus('disconnected', '„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº');
                });

                // Êé•Á∂öÁä∂ÊÖã„ÇíÁõ£Ë¶ñ
                database.ref('.info/connected').on('value', (snapshot) => {
                    if (snapshot.val() === true) {
                        updateConnectionStatus('connected');
                    } else {
                        updateConnectionStatus('disconnected', 'Êé•Á∂ö„ÅåÂàáÊñ≠„Åï„Çå„Åæ„Åó„Åü');
                    }
                });

            } catch (error) {
                console.error('FirebaseÁõ£Ë¶ñË®≠ÂÆö„Ç®„É©„Éº:', error);
                updateConnectionStatus('disconnected', 'FirebaseÊé•Á∂ö„Ç®„É©„Éº');
            }
        }

        // Firebase„Å´„Éá„Éº„Çø„Çí‰øùÂ≠ò
        function saveFirebaseData(item, count) {
            if (!database || !isFirebaseConnected) {
                alert('„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Êé•Á∂ö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                return;
            }

            try {
                database.ref(`cafeRanking/${item}`).set(count)
                    .then(() => {
                        console.log(`${item}: ${count} ‰øùÂ≠òÂÆå‰∫Ü`);
                    })
                    .catch((error) => {
                        console.error('Firebase‰øùÂ≠ò„Ç®„É©„Éº:', error);
                        alert('„Éá„Éº„Çø‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                    });
            } catch (error) {
                console.error('Firebase‰øùÂ≠ò„Ç®„É©„Éº:', error);
                alert('„Éá„Éº„Çø‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
            }
        }

        // Ë°®Á§∫„ÇíÊõ¥Êñ∞
        function updateDisplay() {
            items.forEach((item, i) => {
                const countElement = document.getElementById(`count-${item}`);
                if (countElement) {
                    countElement.textContent = itemCounts[item] || 0;
                }
                if (chart && chart.data && chart.data.datasets[0]) {
                    chart.data.datasets[0].data[i] = itemCounts[item] || 0;
                }
            });
            if (chart) {
                chart.update('none');
            }
        }

        // „Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà
        function resetAllData() {
            if (!isFirebaseConnected) {
                alert('„Éá„Éº„Çø„Éô„Éº„Çπ„Å´Êé•Á∂ö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                return;
            }

            if (confirm('ÂÖ®„Å¶„ÅÆ„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºü')) {
                try {
                    database.ref('cafeRanking').remove()
                        .then(() => {
                            console.log('„Éá„Éº„Çø„É™„Çª„ÉÉ„ÉàÂÆå‰∫Ü');
                        })
                        .catch((error) => {
                            console.error('„É™„Çª„ÉÉ„Éà„Ç®„É©„Éº:', error);
                            alert('„Éá„Éº„Çø„É™„Çª„ÉÉ„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                        });
                } catch (error) {
                    console.error('„É™„Çª„ÉÉ„Éà„Ç®„É©„Éº:', error);
                    alert('„Éá„Éº„Çø„É™„Çª„ÉÉ„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            }
        }

        // UI‰ΩúÊàê
        items.forEach((item, index) => {
            const div = document.createElement("div");
            div.className = "item";
            
            // ÂàùÊúüÂÄ§Ë®≠ÂÆö
            itemCounts[item] = 0;
            
            if (isStaff) {
                div.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">${item}</div>
                    </div>
                    <div class="item-controls">
                        <button class="minus" title="Êï∞Èáè„ÇíÊ∏õ„Çâ„Åô" disabled>‚àí</button>
                        <span class="item-count" id="count-${item}">0</span>
                        <button class="plus" title="Êï∞Èáè„ÇíÂ¢ó„ÇÑ„Åô" disabled>Ôºã</button>
                    </div>
                `;
            } else {
                div.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">${item}</div>
                    </div>
                    <div class="item-count" id="count-${item}">0</div>
                `;
            }
            
            itemListDiv.appendChild(div);

            // Â∫óÂì°„É¢„Éº„Éâ„ÅÆÂ†¥Âêà„ÅÆ„Åø„Éú„Çø„É≥„Ç§„Éô„É≥„Éà„ÇíË®≠ÂÆö
            if (isStaff) {
                const plusBtn = div.querySelector(".plus");
                const minusBtn = div.querySelector(".minus");
                
                if (plusBtn) {
                    plusBtn.onclick = () => {
                        if (isFirebaseConnected) {
                            const newCount = (itemCounts[item] || 0) + 1;
                            saveFirebaseData(item, newCount);
                        }
                    };
                }
                
                if (minusBtn) {
                    minusBtn.onclick = () => {
                        if (isFirebaseConnected) {
                            const newCount = Math.max(0, (itemCounts[item] || 0) - 1);
                            saveFirebaseData(item, newCount);
                        }
                    };
                }
            }
        });

        // Chart.jsÂàùÊúüÂåñ
        let chart;
        const ctx = document.getElementById("chart");
        if (ctx) {
            chart = new Chart(ctx.getContext("2d"), {
                type: 'bar',
                data: {
                    labels: items,
                    datasets: [{
                        label: 'Â£≤‰∏äÊï∞',
                        data: items.map(item => itemCounts[item] || 0),
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.8)',
                            'rgba(54, 162, 235, 0.8)',
                            'rgba(255, 205, 86, 0.8)',
                            'rgba(75, 192, 192, 0.8)',
                            'rgba(153, 102, 255, 0.8)',
                            'rgba(255, 159, 64, 0.8)',
                            'rgba(199, 199, 199, 0.8)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 205, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)',
                            'rgba(199, 199, 199, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    devicePixelRatio: window.devicePixelRatio || 1,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: window.innerWidth < 480 ? 12 : 14
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                font: {
                                    size: window.innerWidth < 480 ? 10 : 12
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                font: {
                                    size: window.innerWidth < 480 ? 10 : 12
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 500
                    }
                }
            });
        }

        // FirebaseÊé•Á∂öÈñãÂßã
        if (database) {
            loadFirebaseData();
        } else {
            // FirebaseË®≠ÂÆö„Åå‰∏çÊ≠£„Å™Â†¥Âêà„ÄÅLocalStorage„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
            console.warn('FirebaseÊú™Ë®≠ÂÆö„ÅÆ„Åü„ÇÅ„ÄÅLocalStorage„Çí‰ΩøÁî®„Åó„Åæ„ÅôÔºàÁ´ØÊú´ÈñìÂêåÊúü„Å™„ÅóÔºâ');
            updateConnectionStatus('disconnected', 'FirebaseÊú™Ë®≠ÂÆö - „É≠„Éº„Ç´„É´„É¢„Éº„Éâ');
            
            // LocalStorage„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÂá¶ÁêÜ
            items.forEach(item => {
                try {
                    const savedCount = localStorage.getItem(`cafe_${item}`);
                    itemCounts[item] = savedCount ? parseInt(savedCount) : 0;
                } catch(e) {
                    itemCounts[item] = 0;
                }
            });
            updateDisplay();
        }

        // „É™„Çµ„Ç§„Ç∫ÊôÇ„ÅÆÂá¶ÁêÜ
        window.addEventListener('resize', function() {
            setTimeout(() => {
                if (chart) {
                    const isMobile = window.innerWidth < 480;
                    chart.options.plugins.legend.labels.font.size = isMobile ? 12 : 14;
                    chart.options.scales.x.ticks.font.size = isMobile ? 10 : 12;
                    chart.options.scales.y.ticks.font.size = isMobile ? 10 : 12;
                    chart.resize();
                }
            }, 100);
        });

        // „Ç™„É™„Ç®„É≥„ÉÜ„Éº„Ç∑„Éß„É≥Â§âÊõ¥ÊôÇ„ÅÆÂá¶ÁêÜ
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                if (chart) {
                    chart.resize();
                }
            }, 100);
        });
    </script>
</body>
</html>
